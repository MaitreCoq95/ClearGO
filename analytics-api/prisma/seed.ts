/**
 * Prisma Seed Script - GDP Actions & Templates
 * Ex√©cution: npx prisma db seed
 */

import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

async function seedGDPActions() {
  console.log('üìä Seeding GDP Actions...')

  const gdpActions = [
    {
      standardType: 'GDP',
      actionCode: 'gdp-qs-1',
      title: 'Cr√©ation du Manuel Qualit√© GDP',
      description: 'R√©diger un manuel qualit√© conforme aux exigences GDP.',
      requirementRef: 'quality-system',
      chapterNumber: 'quality-system',
      estimatedHours: 24,
      priorityWeight: 10,
      category: 'documentation',
      sectorVariations: { deliverables: ['Manuel Qualit√© GDP', 'Proc√©dures associ√©es'], tips: [] },
      templateIds: [],
      dependsOnActions: [],
      displayOrder: 1,
    },
    {
      standardType: 'GDP',
      actionCode: 'gdp-qs-2',
      title: 'D√©signation du Pharmacien Responsable',
      description: 'Formaliser la d√©signation et les responsabilit√©s du PR.',
      requirementRef: 'quality-system',
      chapterNumber: 'quality-system',
      estimatedHours: 4,
      priorityWeight: 10,
      category: 'management',
      sectorVariations: { deliverables: ['Lettre de mission PR', 'D√©l√©gations document√©es'], tips: [] },
      templateIds: [],
      dependsOnActions: [],
      displayOrder: 2,
    },
    {
      standardType: 'GDP',
      actionCode: 'gdp-per-1',
      title: 'Plan de formation GDP',
      description: '√âtablir un programme de formation initiale et continue GDP.',
      requirementRef: 'personnel',
      chapterNumber: 'personnel',
      estimatedHours: 16,
      priorityWeight: 10,
      category: 'training',
      sectorVariations: { deliverables: ['Plan de formation GDP', 'Supports de formation', '√âvaluations'], tips: [] },
      templateIds: [],
      dependsOnActions: [],
      displayOrder: 3,
    },
    {
      standardType: 'GDP',
      actionCode: 'gdp-per-2',
      title: 'Fiches de poste GDP',
      description: 'Cr√©er les fiches de poste incluant les responsabilit√©s GDP.',
      requirementRef: 'personnel',
      chapterNumber: 'personnel',
      estimatedHours: 8,
      priorityWeight: 7,
      category: 'documentation',
      sectorVariations: { deliverables: ['Fiches de poste', 'Organigramme'], tips: [] },
      templateIds: [],
      dependsOnActions: [],
      displayOrder: 4,
    },
    {
      standardType: 'GDP',
      actionCode: 'gdp-prem-1',
      title: 'Qualification thermique des zones de stockage',
      description: 'R√©aliser le mapping thermique et qualifier les zones.',
      requirementRef: 'premises',
      chapterNumber: 'premises',
      estimatedHours: 40,
      priorityWeight: 10,
      category: 'infrastructure',
      sectorVariations: { deliverables: ['Rapport de mapping', 'Protocole de qualification', 'PV de qualification'], tips: [] },
      templateIds: [],
      dependsOnActions: [],
      displayOrder: 5,
    },
    {
      standardType: 'GDP',
      actionCode: 'gdp-prem-2',
      title: 'Syst√®me de monitoring temp√©rature',
      description: 'Installer un syst√®me de surveillance continue avec alertes.',
      requirementRef: 'premises',
      chapterNumber: 'premises',
      estimatedHours: 24,
      priorityWeight: 10,
      category: 'infrastructure',
      sectorVariations: { deliverables: ['Syst√®me install√©', 'Proc√©dure de surveillance', "Seuils d'alerte"], tips: [] },
      templateIds: [],
      dependsOnActions: [],
      displayOrder: 6,
    },
    {
      standardType: 'GDP',
      actionCode: 'gdp-prem-3',
      title: 'S√©curisation des acc√®s',
      description: "Mettre en place un contr√¥le d'acc√®s aux zones de stockage.",
      requirementRef: 'premises',
      chapterNumber: 'premises',
      estimatedHours: 16,
      priorityWeight: 7,
      category: 'infrastructure',
      sectorVariations: { deliverables: ["Syst√®me d'acc√®s", 'Registre des autorisations'], tips: [] },
      templateIds: [],
      dependsOnActions: [],
      displayOrder: 7,
    },
    {
      standardType: 'GDP',
      actionCode: 'gdp-doc-1',
      title: 'Syst√®me de gestion documentaire GDP',
      description: 'Mettre en place la ma√Ætrise des documents GDP.',
      requirementRef: 'documentation',
      chapterNumber: 'documentation',
      estimatedHours: 12,
      priorityWeight: 7,
      category: 'infrastructure',
      sectorVariations: { deliverables: ['Proc√©dure documentaire', 'Liste des documents ma√Ætris√©s'], tips: [] },
      templateIds: [],
      dependsOnActions: [],
      displayOrder: 8,
    },
    {
      standardType: 'GDP',
      actionCode: 'gdp-ops-1',
      title: 'Proc√©dure de qualification fournisseurs',
      description: '√âtablir le processus de qualification des fournisseurs GDP.',
      requirementRef: 'operations',
      chapterNumber: 'operations',
      estimatedHours: 16,
      priorityWeight: 10,
      category: 'process',
      sectorVariations: { deliverables: ['Proc√©dure qualification', "Questionnaire d'audit", 'Registre fournisseurs'], tips: [] },
      templateIds: [],
      dependsOnActions: [],
      displayOrder: 9,
    },
    {
      standardType: 'GDP',
      actionCode: 'gdp-ops-2',
      title: 'Proc√©dure de r√©ception',
      description: 'Formaliser les contr√¥les √† r√©ception des produits.',
      requirementRef: 'operations',
      chapterNumber: 'operations',
      estimatedHours: 8,
      priorityWeight: 10,
      category: 'process',
      sectorVariations: { deliverables: ['Proc√©dure r√©ception', 'Checklist de contr√¥le'], tips: [] },
      templateIds: [],
      dependsOnActions: [],
      displayOrder: 10,
    },
    {
      standardType: 'GDP',
      actionCode: 'gdp-ops-3',
      title: 'Gestion FEFO/FIFO',
      description: 'Mettre en place la gestion des p√©remptions.',
      requirementRef: 'operations',
      chapterNumber: 'operations',
      estimatedHours: 8,
      priorityWeight: 7,
      category: 'process',
      sectorVariations: { deliverables: ['Proc√©dure FEFO', 'Param√©trage WMS'], tips: [] },
      templateIds: [],
      dependsOnActions: [],
      displayOrder: 11,
    },
    {
      standardType: 'GDP',
      actionCode: 'gdp-ops-4',
      title: 'Proc√©dure de gestion des retours',
      description: 'Formaliser le processus de traitement des retours.',
      requirementRef: 'operations',
      chapterNumber: 'operations',
      estimatedHours: 8,
      priorityWeight: 7,
      category: 'process',
      sectorVariations: { deliverables: ['Proc√©dure retours', 'Zone de quarantaine'], tips: [] },
      templateIds: [],
      dependsOnActions: [],
      displayOrder: 12,
    },
    {
      standardType: 'GDP',
      actionCode: 'gdp-comp-1',
      title: 'Proc√©dure de gestion des r√©clamations',
      description: 'Cr√©er le processus de traitement des r√©clamations.',
      requirementRef: 'complaints',
      chapterNumber: 'complaints',
      estimatedHours: 8,
      priorityWeight: 7,
      category: 'process',
      sectorVariations: { deliverables: ['Proc√©dure r√©clamations', 'Formulaire de r√©clamation'], tips: [] },
      templateIds: [],
      dependsOnActions: [],
      displayOrder: 13,
    },
    {
      standardType: 'GDP',
      actionCode: 'gdp-comp-2',
      title: 'Proc√©dure produits falsifi√©s',
      description: '√âtablir le processus de d√©tection des produits suspects.',
      requirementRef: 'complaints',
      chapterNumber: 'complaints',
      estimatedHours: 8,
      priorityWeight: 10,
      category: 'process',
      sectorVariations: { deliverables: ['Proc√©dure falsification', 'Formation √©quipe'], tips: [] },
      templateIds: [],
      dependsOnActions: [],
      displayOrder: 14,
    },
    {
      standardType: 'GDP',
      actionCode: 'gdp-trans-1',
      title: 'Qualification des transporteurs',
      description: 'Qualifier les prestataires de transport GDP.',
      requirementRef: 'transport',
      chapterNumber: 'transport',
      estimatedHours: 24,
      priorityWeight: 10,
      category: 'process',
      sectorVariations: { deliverables: ['Questionnaire qualification', 'Accords qualit√©', 'Audits'], tips: [] },
      templateIds: [],
      dependsOnActions: [],
      displayOrder: 15,
    },
    {
      standardType: 'GDP',
      actionCode: 'gdp-trans-2',
      title: 'Qualification des emballages',
      description: "Valider les solutions d'emballage pour la cha√Æne du froid.",
      requirementRef: 'transport',
      chapterNumber: 'transport',
      estimatedHours: 32,
      priorityWeight: 10,
      category: 'infrastructure',
      sectorVariations: { deliverables: ['√âtudes de qualification', 'Profils thermiques', 'Choix emballages'], tips: [] },
      templateIds: [],
      dependsOnActions: [],
      displayOrder: 16,
    },
  ]

  for (const action of gdpActions) {
    await prisma.action.upsert({
      where: { actionCode: action.actionCode },
      update: action,
      create: action,
    })
  }

  console.log(`‚úÖ ${gdpActions.length} actions GDP ins√©r√©es`)
}

async function seedGDPTemplates() {
  console.log('üìö Seeding GDP Templates...')

  const gdpTemplates = [
    {
      standardType: 'GDP',
      templateCode: 'gdp-manuel-qualite',
      title: 'Manuel Qualit√© GDP',
      description: 'Manuel qualit√© conforme aux Bonnes Pratiques de Distribution.',
      category: 'manuel',
      fileFormat: 'docx',
      fileUrl: 'https://placeholder.com/gdp-manuel-qualite.docx',
      fileSize: 0,
      requirementRef: null,
      sectorAdaptations: { tags: ['obligatoire', 'pharmacien responsable'], estimatedCompletionHours: 24 },
      relatedActionCodes: [],
      downloadCount: 0,
      displayOrder: 1,
      isActive: true,
    },
    {
      standardType: 'GDP',
      templateCode: 'gdp-programme-surete',
      title: 'Programme de S√ªret√© Supply Chain',
      description: "Programme de s√©curisation de la cha√Æne d'approvisionnement.",
      category: 'manuel',
      fileFormat: 'docx',
      fileUrl: 'https://placeholder.com/gdp-programme-surete.docx',
      fileSize: 0,
      requirementRef: null,
      sectorAdaptations: { tags: ['s√ªret√©', 'falsification'], estimatedCompletionHours: 12 },
      relatedActionCodes: [],
      downloadCount: 0,
      displayOrder: 2,
      isActive: true,
    },
    {
      standardType: 'GDP',
      templateCode: 'gdp-procedure-reception',
      title: 'Proc√©dure R√©ception',
      description: 'Proc√©dure de contr√¥le √† r√©ception des produits pharmaceutiques.',
      category: 'procedure',
      fileFormat: 'docx',
      fileUrl: 'https://placeholder.com/gdp-procedure-reception.docx',
      fileSize: 0,
      requirementRef: 'operations',
      sectorAdaptations: { tags: ['r√©ception', 'contr√¥le'], estimatedCompletionHours: 6 },
      relatedActionCodes: [],
      downloadCount: 0,
      displayOrder: 3,
      isActive: true,
    },
    {
      standardType: 'GDP',
      templateCode: 'gdp-procedure-stockage',
      title: 'Proc√©dure Stockage',
      description: 'Proc√©dure de stockage et conditions de conservation.',
      category: 'procedure',
      fileFormat: 'docx',
      fileUrl: 'https://placeholder.com/gdp-procedure-stockage.docx',
      fileSize: 0,
      requirementRef: 'premises',
      sectorAdaptations: { tags: ['stockage', 'temp√©rature'], estimatedCompletionHours: 6 },
      relatedActionCodes: [],
      downloadCount: 0,
      displayOrder: 4,
      isActive: true,
    },
    {
      standardType: 'GDP',
      templateCode: 'gdp-procedure-expedition',
      title: 'Proc√©dure Exp√©dition',
      description: 'Proc√©dure de pr√©paration et exp√©dition des commandes.',
      category: 'procedure',
      fileFormat: 'docx',
      fileUrl: 'https://placeholder.com/gdp-procedure-expedition.docx',
      fileSize: 0,
      requirementRef: 'operations',
      sectorAdaptations: { tags: ['exp√©dition', 'livraison'], estimatedCompletionHours: 6 },
      relatedActionCodes: [],
      downloadCount: 0,
      displayOrder: 5,
      isActive: true,
    },
    {
      standardType: 'GDP',
      templateCode: 'gdp-procedure-retours',
      title: 'Proc√©dure Retours',
      description: 'Proc√©dure de gestion des retours clients.',
      category: 'procedure',
      fileFormat: 'docx',
      fileUrl: 'https://placeholder.com/gdp-procedure-retours.docx',
      fileSize: 0,
      requirementRef: 'operations',
      sectorAdaptations: { tags: ['retours', 'quarantaine'], estimatedCompletionHours: 4 },
      relatedActionCodes: [],
      downloadCount: 0,
      displayOrder: 6,
      isActive: true,
    },
    {
      standardType: 'GDP',
      templateCode: 'gdp-procedure-rappel',
      title: 'Proc√©dure Rappel de Lots',
      description: 'Proc√©dure de rappel de lots et retrait du march√©.',
      category: 'procedure',
      fileFormat: 'docx',
      fileUrl: 'https://placeholder.com/gdp-procedure-rappel.docx',
      fileSize: 0,
      requirementRef: null,
      sectorAdaptations: { tags: ['rappel', 'vigilance'], estimatedCompletionHours: 6 },
      relatedActionCodes: [],
      downloadCount: 0,
      displayOrder: 7,
      isActive: true,
    },
    {
      standardType: 'GDP',
      templateCode: 'gdp-procedure-falsification',
      title: 'Proc√©dure Produits Falsifi√©s',
      description: 'Proc√©dure de d√©tection des produits suspects/falsifi√©s.',
      category: 'procedure',
      fileFormat: 'docx',
      fileUrl: 'https://placeholder.com/gdp-procedure-falsification.docx',
      fileSize: 0,
      requirementRef: 'complaints',
      sectorAdaptations: { tags: ['falsification', 's√ªret√©'], estimatedCompletionHours: 6 },
      relatedActionCodes: [],
      downloadCount: 0,
      displayOrder: 8,
      isActive: true,
    },
    {
      standardType: 'GDP',
      templateCode: 'gdp-fiche-reception',
      title: 'Fiche Contr√¥le R√©ception',
      description: 'Checklist de contr√¥le √† r√©ception.',
      category: 'formulaire',
      fileFormat: 'docx',
      fileUrl: 'https://placeholder.com/gdp-fiche-reception.docx',
      fileSize: 0,
      requirementRef: null,
      sectorAdaptations: { tags: ['enregistrement', 'r√©ception'], estimatedCompletionHours: 1 },
      relatedActionCodes: [],
      downloadCount: 0,
      displayOrder: 9,
      isActive: true,
    },
    {
      standardType: 'GDP',
      templateCode: 'gdp-fiche-deviation',
      title: 'Fiche D√©viation Temp√©rature',
      description: "Formulaire de d√©claration d'excursion thermique.",
      category: 'formulaire',
      fileFormat: 'docx',
      fileUrl: 'https://placeholder.com/gdp-fiche-deviation.docx',
      fileSize: 0,
      requirementRef: null,
      sectorAdaptations: { tags: ['temp√©rature', 'd√©viation'], estimatedCompletionHours: 1 },
      relatedActionCodes: [],
      downloadCount: 0,
      displayOrder: 10,
      isActive: true,
    },
    {
      standardType: 'GDP',
      templateCode: 'gdp-questionnaire-transporteur',
      title: 'Questionnaire Qualification Transporteur',
      description: "Questionnaire d'√©valuation des transporteurs.",
      category: 'formulaire',
      fileFormat: 'docx',
      fileUrl: 'https://placeholder.com/gdp-questionnaire-transporteur.docx',
      fileSize: 0,
      requirementRef: 'transport',
      sectorAdaptations: { tags: ['transporteur', 'qualification'], estimatedCompletionHours: 2 },
      relatedActionCodes: [],
      downloadCount: 0,
      displayOrder: 11,
      isActive: true,
    },
    {
      standardType: 'GDP',
      templateCode: 'gdp-mapping-thermique',
      title: 'Protocole Mapping Thermique',
      description: 'Protocole de cartographie thermique des zones de stockage.',
      category: 'outil',
      fileFormat: 'docx',
      fileUrl: 'https://placeholder.com/gdp-mapping-thermique.docx',
      fileSize: 0,
      requirementRef: 'premises',
      sectorAdaptations: { tags: ['qualification', 'temp√©rature'], estimatedCompletionHours: 8 },
      relatedActionCodes: [],
      downloadCount: 0,
      displayOrder: 12,
      isActive: true,
    },
    {
      standardType: 'GDP',
      templateCode: 'gdp-plan-formation',
      title: 'Plan de Formation GDP',
      description: 'Template de plan de formation aux BPD.',
      category: 'outil',
      fileFormat: 'xlsx',
      fileUrl: 'https://placeholder.com/gdp-plan-formation.xlsx',
      fileSize: 0,
      requirementRef: 'personnel',
      sectorAdaptations: { tags: ['formation', 'RH'], estimatedCompletionHours: 4 },
      relatedActionCodes: [],
      downloadCount: 0,
      displayOrder: 13,
      isActive: true,
    },
  ]

  for (const template of gdpTemplates) {
    await prisma.template.upsert({
      where: { templateCode: template.templateCode },
      update: template,
      create: template,
    })
  }

  console.log(`‚úÖ ${gdpTemplates.length} templates GDP ins√©r√©s`)
}

async function main() {
  console.log('\nüöÄ D√©marrage du seed Prisma...\n')
  console.log('================================================\n')

  try {
    await seedGDPActions()
    await seedGDPTemplates()

    console.log('\n================================================')
    console.log('‚úÖ Seed termin√© avec succ√®s!')
    console.log('   - 16 actions GDP')
    console.log('   - 13 templates GDP\n')
  } catch (error) {
    console.error('‚ùå Erreur lors du seed:', error)
    throw error
  } finally {
    await prisma.$disconnect()
  }
}

main()
